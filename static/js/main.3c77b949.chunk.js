(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{101:function(e,t,n){},103:function(e,t,n){},107:function(e,t){},109:function(e,t){},142:function(e,t){},143:function(e,t){},185:function(e,t){},186:function(e,t){},187:function(e,t){},188:function(e,t){},189:function(e,t,n){"use strict";n.r(t);var a=n(5),i=n.n(a),r=n(93),s=n.n(r),o=(n(101),n(23)),c=n(14),u=n.n(c),d=n(32),l=n(33),f=n(34),h=n(36),v=n(35),m=n(37),p=(n(103),n(55)),b=n(94),x=n(7),g=n(95),y=(i.a.Component,function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(h.a)(this,Object(v.a)(t).call(this,e))).detectFrame=function(e,t){t.detect(e).then(function(a){n.renderPredictions(a),requestAnimationFrame(function(){n.detectFrame(e,t)})})},n.renderPredictions=function(e){var t=n.videoCanvasRef.current.getContext("2d");t.clearRect(0,0,t.canvas.width,t.canvas.height);var a="16px sans-serif";t.font=a,t.textBaseline="top",e.forEach(function(e){var n=e.bbox[0],i=e.bbox[1],r=e.bbox[2],s=e.bbox[3];t.strokeStyle="#00FFFF",t.lineWidth=4,t.strokeRect(n,i,r,s),t.fillStyle="#00FFFF";var o=t.measureText(e.class).width,c=parseInt(a,10);t.fillRect(n,i,o+4,c+4)}),e.forEach(function(e){var n=e.bbox[0],a=e.bbox[1];t.fillStyle="#000000",t.fillText(e.class,n,a)})},n.videoCanvasRef=i.a.createRef(),n.state={video:void 0,videoWidth:300,videoHeight:250,NUM_CLASSES:3,TOPK:3,infoTexts:[],training:-1,modelPromise:void 0,classifier:void 0},n}return Object(m.a)(t,e),Object(f.a)(t,[{key:"animate",value:function(){var e=Object(d.a)(u.a.mark(function e(){var t,n,a,i,r,s,o,c,d,l,f=this;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.video,n=x.browser.fromPixels(t),i=function(){return f.state.modelPromise.infer(n,"conv_preds")},-1!==this.state.training&&(a=i(),this.state.classifier.addExample(a,this.state.training)),e.next=6,this.state.classifier.getNumClasses();case 6:if(!(e.sent>0)){e.next=33;break}return a=i(),e.next=11,this.state.classifier.predictClass(a,this.state.TOPK);case 11:r=e.sent,s=0;case 13:if(!(s<this.state.NUM_CLASSES)){e.next=33;break}if(r.classIndex===s?this.state.infoTexts[s].style.fontWeight="bold":this.state.infoTexts[s].style.fontWeight="normal",!((o=this.state.classifier.getClassExampleCount())[s]>0)){e.next=30;break}c=100*r.confidences[s],this.state.infoTexts[s].innerText=" ".concat(o[s]," examples - ").concat(c,"%"),d=this.state.infoTexts.map(function(e,t){var n=parseInt(e.innerText.slice(e.innerHTML.length-4,e.innerHTML.length-1));return{index:t,value:n||0}}),l=d.sort(function(e,t){return t.value-e.value})[0],e.t0=l.index,e.next=0===e.t0?24:1===e.t0?26:2===e.t0?28:30;break;case 24:return document.body.style.background="#288340",e.abrupt("break",30);case 26:return document.body.style.background="#9B1617",e.abrupt("break",30);case 28:return document.body.style.background="#083C84",e.abrupt("break",30);case 30:s++,e.next=13;break;case 33:n.dispose(),null!=a&&a.dispose(),requestAnimationFrame(this.animate.bind(this));case 36:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=this;document.onreadystatechange=function(){"complete"===document.readyState&&(e.setupGui(),e.setupCam())}}},{key:"setupGui",value:function(){for(var e=this,t=function(t){var n=document.createElement("div");document.body.appendChild(n),n.style.marginBottom="10px";var a=document.createElement("button");a.innerText="Treinar "+t,n.appendChild(a),a.addEventListener("click",function(){e.setState(function(e){return Object(o.a)({},e,{training:t})}),e.animate(),requestAnimationFrame(function(){e.setState(function(e){return Object(o.a)({},e,{training:-1})})})});var i=document.createElement("span");i.innerText=" Nenhum exemplo criado",n.appendChild(i),e.state.infoTexts.push(i)},n=0;n<this.state.NUM_CLASSES;n++)t(n)}},{key:"setupCamera",value:function(){var e=Object(d.a)(u.a.mark(function e(){var t,n=this;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){e.next=2;break}throw new Error("Browser API navigator.mediaDevices.getUserMedia not available");case 2:return this.state.video=document.getElementById("video"),this.state.video.width=this.state.videoWidth,this.state.video.height=this.state.videoHeight,e.next=7,navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user",width:this.state.videoWidth,height:this.state.videoHeight}});case 7:return t=e.sent,this.state.video.srcObject=t,e.abrupt("return",new Promise(function(e){n.state.video.onloadedmetadata=function(){e(n.state.video)}}));case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setupCam",value:function(){var e=Object(d.a)(u.a.mark(function e(){var t,n,a=this;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){e.next=7;break}return e.next=3,this.setupCamera();case 3:t=e.sent,n=p.a(),this.setState(function(e){return Object(o.a)({},e,{modelPromise:b.a(2),classifier:g.a()})}),Promise.all([this.state.modelPromise,t,n]).then(function(e){a.setState(function(t){return Object(o.a)({},t,{modelPromise:e[0]})}),a.detectFrame(e[1],e[2])}).catch(function(e){console.error(e)});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement("video",{id:"video",autoPlay:!0,playsInline:!0,muted:!0}),i.a.createElement("canvas",{className:"size",ref:this.videoCanvasRef,width:"300",height:"250"}))}}]),t}(i.a.Component)),k=function(e){function t(){return Object(l.a)(this,t),Object(h.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return i.a.createElement("div",null,i.a.createElement(y,null))}}]),t}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(i.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},96:function(e,t,n){e.exports=n(189)}},[[96,1,2]]]);
//# sourceMappingURL=main.3c77b949.chunk.js.map